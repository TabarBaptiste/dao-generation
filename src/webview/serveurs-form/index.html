<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'none'; style-src {{cspSource}} 'unsafe-inline' https://unpkg.com; font-src https://unpkg.com; script-src {{cspSource}} 'unsafe-inline';">
    <title>Connexion au serveur</title>
    <link rel="stylesheet" type="text/css" href="{{cssUri}}">
    <link rel="stylesheet" href="https://unpkg.com/@vscode/codicons@0.0.35/dist/codicon.css">
</head>

<body>
    <div class="container">
        <h1>
            <i id="titleIcon" class="codicon codicon-add"></i>
            <span id="formTitle">Connexion au serveur</span>
        </h1>

        <form id="serveurForm">
            <div class="form-group">
                <label for="name">
                    <i class="codicon codicon-tag"></i>
                    Nom du serveur
                </label>
                <input type="text" id="name" name="name" disabled
                    style="background-color: transparent; border: transparent;">
                <!-- <div class="help-text">A friendly name to identify this serveurs</div> -->
            </div>

            <div class="form-group">
                <label for="type">
                    <i class="codicon codicon-server-environment"></i>
                    Type de serveur <span class="required">*</span>
                </label>
                <select id="type" name="type" required>
                    <option value="mysql">MySQL</option>
                    <option value="mariadb">MariaDB</option>
                    <option value="postgresql">PostgreSQL</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="host">
                        <i class="codicon codicon-server"></i>
                        Host <span class="required">*</span>
                    </label>
                    <input type="text" id="host" name="host" placeholder="localhost" required>
                </div>

                <div class="form-group">
                    <label for="port">
                        <i class="codicon codicon-radio-tower"></i>
                        Port <span class="required">*</span>
                    </label>
                    <input type="number" id="port" name="port" min="1" max="65535" value="3306" required
                        onkeydown="return !['e', 'E', '+', '-'].includes(event.key)"
                        oninput="this.value = this.value.replace(/[eE\+\-]/g, '')">
                </div>
            </div>

            <div class="form-group">
                <label for="username">
                    <i class="codicon codicon-person"></i>
                    Username <span class="required">*</span>
                </label>
                <input type="text" id="username" name="username" placeholder="root" required>
            </div>

            <div class="form-group">
                <label for="password">
                    <i class="codicon codicon-key"></i>
                    Password
                </label>
                <div class="password-input-group">
                    <input type="password" id="password" name="password">
                    <button type="button" id="togglePasswordBtn" class="btn-toggle-password"
                        title="Afficher/masquer le mot de passe">
                        <i class="codicon codicon-eye"></i>
                    </button>
                </div>
            </div>

            <div class="form-group">
                <label for="database">
                    <i class="codicon codicon-database"></i>
                    Database
                </label>
                <div class="database-input-group">
                    <input type="text" id="database" name="database" list="databaseList" placeholder="Saisir ou sélectionner une base de données...">
                    <datalist id="databaseList"></datalist>
                    <button type="button" id="loadDbBtn" class="btn-load-db" title="Charger les bases de données">
                        <i class="codicon codicon-refresh"></i>
                    </button>
                </div>
                <div class="help-text">Saisissez le nom de la base ou cliquez sur le bouton de rafraîchissement pour charger les bases disponibles (obligatoire pour PostgreSQL)</div>
            </div>

            <div class="form-group" id="defaultDaoPathGroup">
                <label for="defaultDaoPath">
                    <i class="codicon codicon-folder"></i>
                    Répertoire du projet
                </label>
                <div class="path-input-group">
                    <input type="text" id="defaultDaoPath" name="defaultDaoPath"
                        placeholder="Cliquez sur le bouton pour sélectionner un dossier...">
                    <button type="button" id="selectPathBtn" class="btn-select-path" title="Sélectionner un dossier">
                        <i class="codicon codicon-folder-opened"></i>
                    </button>
                </div>
                <div class="help-text">Si défini, les DAO seront générés automatiquement dans ce répertoire</div>
            </div>

            <!-- Section SSL/TLS -->
            <div class="ssl-section">
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="ssl" name="ssl">
                        <label for="ssl">
                            <i class="codicon codicon-lock"></i>
                            Activer SSL/TLS
                        </label>
                    </div>
                    <div class="help-text">Utiliser une connexion sécurisée SSL/TLS</div>
                </div>

                <div id="sslOptionsGroup" class="ssl-options" style="display: none;">
                    <div class="form-group">
                        <label for="sslCa">
                            <i class="codicon codicon-file-code"></i>
                            Certificat CA (optionnel)
                        </label>
                        <div class="path-input-group">
                            <input type="text" id="sslCa" name="sslCa" placeholder="Chemin du certificat CA...">
                            <button type="button" id="selectCaBtn" class="btn-select-path"
                                title="Sélectionner le certificat CA">
                                <i class="codicon codicon-file"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="sslCert">
                            <i class="codicon codicon-file-code"></i>
                            Certificat client (optionnel)
                        </label>
                        <div class="path-input-group">
                            <input type="text" id="sslCert" name="sslCert"
                                placeholder="Chemin du certificat client...">
                            <button type="button" id="selectCertBtn" class="btn-select-path"
                                title="Sélectionner le certificat client">
                                <i class="codicon codicon-file"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="sslKey">
                            <i class="codicon codicon-key"></i>
                            Clé privée (optionnel)
                        </label>
                        <div class="path-input-group">
                            <input type="text" id="sslKey" name="sslKey" placeholder="Chemin de la clé privée...">
                            <button type="button" id="selectKeyBtn" class="btn-select-path"
                                title="Sélectionner la clé privée">
                                <i class="codicon codicon-file"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="rejectUnauthorized" name="rejectUnauthorized" checked>
                            <label for="rejectUnauthorized">
                                Vérifier le certificat du serveur
                            </label>
                        </div>
                        <div class="help-text">Décochez cette option pour accepter les certificats auto-signés (non
                            recommandé en production)</div>
                    </div>
                </div>
            </div>

            <div class="test-serveurs">
                <button type="button" id="testBtn" class="btn-test">
                    <i class="codicon codicon-plug"></i>
                    Test de connexion
                </button>
                <div id="statusMessage" class="status-message" style="display: none;"></div>
            </div>

            <div class="buttons">
                <button type="button" class="btn-secondary" id="cancelBtn">
                    <i class="codicon codicon-close"></i>
                    Annuler
                </button>
                <button type="submit" class="btn-primary" id="submitBtn">
                    <i class="codicon codicon-check"></i>
                    Créer
                </button>
            </div>
        </form>
    </div>

    <script src="{{jsUri}}"></script>
</body>

</html>